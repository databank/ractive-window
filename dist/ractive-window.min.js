!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("RactiveWindow",[],t):"object"==typeof exports?exports.RactiveWindow=t():e.RactiveWindow=t()}(this,(function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var o,r={ok:{label:"OK",action:function(){this.result="ok",this.close()},position:"middle"},cancel:{label:"Cancel",action:function(){this.result="cancel",this.close()},position:"middle"},yes:{label:"Yes",action:function(){this.result="yes",this.close()},position:"middle"},no:{label:"No",action:function(){this.result="no",this.close()},position:"middle"}},i=(o=0,Ractive.extend({isolated:!0,defaults:{control:{label:function(e,t){Window.partials[e+"ControlLabel"]=t}},controls:function(){for(var e="",t=0;t<arguments.length;t++)e+="{{>"+arguments[t]+"Control}}";Window.partials.controls=e}},components:{Window:Window},data:{windowSlots:[],windows:{},blocks:{},globalBlock:null},computed:{blocked:function(){return!!this.get("globalBlock")}},template:"<div class='ractive-window-host-modal' style='{{^blocked}}display: none;{{/blocked}}'></div><div class='host-content'>{{yield}}</div>{{#windowSlots}}<Window/>{{/windowSlots}}",newWindow:function(e,t){var n=o;o+=1;var r=this;return r.push("windowSlots",n).then((function(){var o,i=r.findAllComponents("Window"),l=i[i.length-1];r.set("windows."+n,l),l.parentNumber=n,l.set({"geometry.index":1e3+i.length,"geometry.left":-9999,"geometry.top":-9999,id:n});var s=function(){var e;return l.raise(),l.set("_wnd_rendered",!0).then((function(){l.element=l.find(".ractive-window");try{if((e=l.activated())&&"function"==typeof e.then)return e}catch(e){console.log(e)}}))},a=function(){return-9999===l.get("geometry.left")?l.move("cascade").then((function(){return l})):l};return o=(o=(o=function(){var n;if(t&&"function"==typeof t)try{if((n=t(l))&&"function"==typeof n.then)return n}catch(e){console.log(e)}else if("function"==typeof e)try{(n=e(l))&&"function"==typeof n.then&&(o=n)}catch(e){console.log(e)}}())?o.then(s):s())?o.then(a):a()}))},killWindow:function(e){var t,n,o=this.get("blocks"),r=this.get("windows"),i=-1;if(r){for(var l in r)r[l]===e?delete r[l]:(n=r[l].get("geometry.index"))>i&&(i=n,t=r[l]);t&&!t.get("topmost")&&(t.set("topmost",!0),t.element&&t.element.getElementsByTagName("iframe").length&&t.element.getElementsByTagName("iframe")[0].focus())}var s=this.get("windowSlots");for(n in s&&this.splice("windowSlots",s.indexOf(e.parentNumber),1),o){var a=o[n];a&&Array.isArray(a)&&a.indexOf(e.parentNumber)>=0&&a.splice(a.indexOf(e.parentNumber),1)}e===this.get("globalBlock")&&this.set("globalBlock",null),this.unblockUnblockedWindows()},raiseWindow:function(e){var t,n=this.get("windows"),o=this.get("windowSlots"),r=this.get("blocks"),i=[],l=this.topLevelBlockers(e);for(var s in l.push(e),n)l.indexOf(n[s])<0&&i.push(n[s]);function a(e,t){for(var o in t){var l=n[t[o]],s=i.indexOf(e),c=i.indexOf(l);if(!(!l||s<0||c<0)){var u=r[l.parentNumber];!u&&Array.isArray(u)&&u.length>0&&a(l,u),s>c&&(i.splice(s,1),i.splice(c,0,e))}}}for(t in i.sort((function(e,t){var n=e.get("geometry.index"),o=t.get("geometry.index");return n<o?-1:n>o?1:0})),e&&(i=i.concat(l)),o){var c=r[o[t]];c&&Array.isArray(c)&&c.length>0&&a(n[o[t]],c)}for(t in i)i[t].set("geometry.index",+t+1e3),i[t]!==e&&i[t].set("topmost",!1);e.get("topmost")||(e.set("topmost",!0),setTimeout((function(){e.element&&e.element.getElementsByTagName("iframe").length&&e.element.getElementsByTagName("iframe")[0].focus()}),300));var u=function e(t){var o=[];if(!t)return o;var i=r[t.parentNumber];if(i&&Array.isArray(i)&&i.length>0)for(var l in i)o=o.concat(e(n[i[l]]));return o.push(t),o}(this.get("globalBlock"));for(t in u)u[t].add("geometry.index",1e4)},topLevelBlockers:function(e){if(!e)return[];var t=this.get("blocks"),n=this.get("windows"),o=t[e.parentNumber],r=[];if(!o||!Array.isArray(o)||0===o.length)return r;for(var i in o){var l=t[o[i]];l&&Array.isArray(l)&&0!==l.length?r=r.concat(this.topLevelBlockers(n[o[i]])):r.push(n[o[i]])}return r},blockWindow:function(e,t){if(e&&t){var n=this.get("blocks"),o=n[e.parentNumber];o&&Array.isArray(o)||(o=[]),o.indexOf(t.parentNumber)<0&&o.push(t.parentNumber),n[e.parentNumber]=o;for(var r=2;r<arguments.length;r++)o.indexOf(arguments[r].parentNumber)<0&&o.push(arguments[r].parentNumber);o.length>0&&e.set("blocked",!0),this.raiseWindow()}},unblockWindow:function(e,t){if(!(!e|!t)){var n=this.get("blocks"),o=n[e.parentNumber];if(o&&Array.isArray(o)){o.indexOf(t.parentNumber)>=0&&o.splice(o.indexOf(t.parentNumber),1);for(var r=2;r<arguments.length;r++)o.indexOf(arguments[r].parentNumber)>=0&&o.splice(o.indexOf(arguments[r].parentNumber),1);0===o.length&&e.set("blocked",!1),this.raiseWindow()}}},unblockUnblockedWindows:function(){var e=this.get("blocks"),t=this.get("windows");for(var n in e){var o=e[n];if(!o||!Array.isArray(o)||0===o.length){var r=t[n];r&&r.set("blocked",!1)}}},messageBox:function(e){var t=arguments,n=this;return new Promise((function(o){n.newWindow((function(i){var l;t.length>=2?(l=t[0],e=t[1]):1===t.length&&"string"==typeof t[0]&&(l=t[0],e={}),i.set("title",e.title||"Message"),i.set("resizable",!1),i.controls("close"),i.content(l);for(var s=e.buttons||["ok"],a=[],c=0;c<s.length;c++)r.hasOwnProperty(s[c])&&a.push(r[s[c]]);i.buttons(a),i.onClose=function(){this.kill(),o(i.result||"none")},e.hasOwnProperty("modal")&&!e.modal||n.set("globalBlock",i),i.activated=function(){i.move("center")}}))}))}}));t.default={Window:1,Container:i}}]).default}));